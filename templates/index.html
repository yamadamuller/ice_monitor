<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Ice monitor</title>
        <link rel="icon" type="image/x-icon" href="https://nuem.ct.utfpr.edu.br/wp-content/uploads/2021/05/favicon.ico">
        <link rel="preconnect" href="https://fonts.googleapis.com">
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link href="https://fonts.googleapis.com/css2?family=Red+Hat+Text:wght@400;700&display=swap" rel="stylesheet">
        <style>
            body {
                font-family: 'Red Hat Text', sans-serif;
                text-align: justify;
                text-justify: inter-word;
                margin: 0;
                padding: 0;
                position: relative;
                min-height: 100vh;
            }

            .highlight-color{
                color: #4A88C3;
            }

            .content {
                max-width: 800px;
                margin: 100px auto 40px;
                padding: 0 20px;
                line-height: 1.6;
                font-size: 1.1rem;
                color: #333;
            }

            .fixed{
                position: fixed;
            }

            .top-0{
                top: 0;
            }

            .left-0{
                left: 0;
            }

            .right-0{
                right: 20;
            }

            .transition-all {
                transition-property: all;
                transition-timing-function: cubic-bezier(.4,0,.2,1);
                transition-duration: .15s;
            }

            .duration-300 {
                animation-duration: .3s;
            }

            .py-5 {
                padding-top: 1.25rem;
                padding-bottom: 1.25rem;
            }

             .items-center {
                align-items: center;
            }

            .img-responsive {
                max-width: 10%;
            }

            .ico_enhanced {
                width: 200%;
                height: 200%;
            }

            .canvas-title {
                text-align: center;
                font-weight: bold;
                margin-bottom: 4px;
            }
            .freq-row {
                display: flex;
                flex-direction: row;  /* side-by-side frequency blocks */
                gap: 20px;
                justify-content: flex-start;
                align-items: flex-start;
            }

            .column-block {
                display: flex;
                flex-direction: column;
                align-items: center;
                min-width: 300px;
            }

            .heatmap-canvas {
                border: 1px solid #ccc;
                margin-bottom: 4px;
            }

            .label {
                text-align: center;
                font-size: 0.9rem;
                margin-bottom: 4px;
            }

            .timestamp-canvas {
                border-top: 1px solid #000;
                margin-top: 2px;
            }


        </style>
    </head>

    <body class="content" style="margin-left:500px;">
        <div>
             <a class="flex items-center" href="/">
                <img src="https://www.udiscovermusic.com/wp-content/uploads/2020/04/Ice-Cube-GettyImages-74305254.jpg"
                     alt="cube_logo" width="35%" height="35%">
            </a>
            <h1 class="highlight-color">Ice monitor</h1>
            <button id="startBtn" onclick="startAcquisition()">Start monitoring</button>
            <button id="stopBtn"  onclick="stopAcquisition()" disabled>Stop monitoring</button>
            <pre id="monitoredFile" class="highlight-color"></pre>
        </div>

        <div id="heatmapContainer" class="freq-row"></div>


        <script>
            const sweepedFreqs = {{ freqs | tojson }};
            let stopUpdate = false;
            let pollingInterval = null;
            let freqData = {};

            function startPolling() {
                pollingInterval = setInterval(fetchAllHeatmaps, 500);
            }

            function stopPolling() {
                clearInterval(pollingInterval);
            }




            async function startAcquisition() {
                stopUpdate = false;
                document.getElementById("startBtn").disabled = true;
                document.getElementById("stopBtn").disabled = false;
                await fetch("/monitor_start");
                //startPolling();
            }

            async function stopAcquisition() {
                stopUpdate = true;
                document.getElementById("startBtn").disabled = false;
                document.getElementById("stopBtn").disabled = true;
                await fetch("/monitor_stop");
                //stopPolling();
            }


        </script>
    </body>
</html>
